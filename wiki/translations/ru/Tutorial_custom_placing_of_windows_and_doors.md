# Tutorial custom placing of windows and doors/ru
{{TutorialInfo/ru
|Topic=Архитектура
|Level=Средний
|Time=60 минут
|Author=[https://forum.freecadweb.org/memberlist.php?mode=viewprofile&u=21943 vocx]
|FCVersion=0.18 или выше
|Files=нет
}}

## Введение

Этот учебник покажет как поместить спроектированное пользователем [окна](Arch_Window/ru.md) и [двери](Arch_Door/ru.md) в модели здания. Он использует верстаки [Draft](Draft_Workbench/ru.md), [Arch](Arch_Workbench/ru.md), и [Sketcher](Sketcher_Workbench/ru.md).


<div class="mw-translate-fuzzy">

Используются следующие инструменты: [Draft Grid](Draft_Grid/ru.md), [Draft Snap](Draft_Snap/ru.md), [Draft Wire](Draft_Wire/ru.md), [Arch Wall](Arch_Wall/ru.md), [Arch Window](Arch_Window/ru.md), и [Sketcher NewSketch](Sketcher_NewSketch/ru.md). Пользователь должен быть знаком с установкой ограничений в эскизах.


</div>

Этот учебник был вдохновлён учебниками, написанными jpg87 на [форумах FreeCAD](https://forum.freecadweb.org/viewforum.php?f=36).

-   [Arch Create a custom window](https://forum.freecadweb.org/viewtopic.php?f=36&t=32883)
-   [Arch : How to use your custom Window](https://forum.freecadweb.org/viewtopic.php?f=36&t=32982)

Посмотрите, пожалуйста, следующую ветку для дополнительной информации о позиционировании окон и дверей.

-   [Discussion: Orientation of Windows and Doors](https://forum.freecadweb.org/viewtopic.php?t=35368)

Посмотрите так же следующую страницу ради некоторых видео о том, как выравнять окна.

-   [The workbench used to create architectural projects is called Arch](http://help-freecad-jpg87.fr/04_arch_ind.php)

## Установка

1\. Откройте FreeCAD, создайте новый пустой документ, и переключитесь на [Верстак Arch](Arch_Workbench/ru.md).

2\. Убедитесь, что единицы измерения установлены в меню **Правка → Настройки → Основные → Единицы измерения** правильно. Например, `МКС (м/кг/с/градус)` хороши для работы с расстояниями в типичных строениях; и установите число знаков после запятой на `4`, чтобы учитывать малейшие доли метра.

3\. Используйте кнопку [Показывать сетку](Draft_ToggleGrid/ru.md) для показа сетки с достаточным разрешением. Вы можете изменить вид сетки в меню **Правка → Настройки → Draft → Сетка и привязка → Сетка**. Установите линии через каждые `50 mm`, с главными линиями каждые `20` линий (каждый метр), и `1000 линий` всего (сетка покрывает площадь 50 x 50 метров).

4\. [Отодвиньте](Zoom_out/ru.md) трёхмерный вид, если сетка слишком близка.

Теперь мы готовы сделать простейшую стену, где мы установим окна и двери.

## Установка стены 


<div class="mw-translate-fuzzy">

5\. Используйте инструмент [Draft Wire](Draft_Wire/ru.md) для создания полилинии. Ведите её против часовой стрелки.

:   5.1. Первая точка в (0, 4, 0); в диалоге введите **0** **m** **Enter**, **4** **m** **Enter**, **0** **m** **Enter**.
:   5.2. Вторая точка в (2, 0, 0); в диалоге введите **2** **m** **Enter**, **0** **m** **Enter**, **0** **m** **Enter**.
:   5.3. Третья точка в (4, 0, 0); в диалоге введите **4** **m** **Enter**, **0** **m** **Enter**, **0** **m** **Enter**.
:   5.4. Четвёртая точка в (6, 2, 0); в диалоге введите **6** **m** **Enter**, **2** **m** **Enter**, **0** **m** **Enter**.
:   5.4. Пятая точка в (6, 5, 0); в диалоге введите **6** **m** **Enter**, **5** **m** **Enter**, **0** **m** **Enter**.
:   5.5. На клавиатуре нажмите **A** для завершения полилинии.
:   5.6. На клавиатуре нажмите **0** для получения [аксонометрического вида](axonometric_view/ru.md) модели.
:   
    **Примечание:**убедитесь, что чекбокс **Относительно (R)** не отмечен, когда вводите абсолютные координаты.
:   
    **Примечание 2:**точки могут быть определены указателем мыши по точкам сетки, с помощью панели [Draft Snap](Draft_Snap/ru.md) и метода [Draft Grid](Draft_Grid/ru.md).
:   
    **Примечание 3:**вы можете создать формы программированием на [Python](Python/ru.md). Учтите, что большинство функций ожидают ввод в миллиметрах.


</div>


```python
import FreeCAD
import Draft

p = [FreeCAD.Vector(0.0, 4000.0, 0),
FreeCAD.Vector(2000.0, 0.0, 0.0),
FreeCAD.Vector(4000.0, 0.0, 0.0),
FreeCAD.Vector(6000.0, 2000.0, 0.0),
FreeCAD.Vector(6000.0, 5000.0, 0.0)]

w = Draft.makeWire(p, closed=False)
```

6\. Выделите `DWire` и кликните инструмент [Arch Wall](Arch_Wall/ru.md); появится стена с шириной (толщиной) по умолчанию 0,2 м и высотой 3 м.

<img alt="" src=images/01_T02_wire_wall.png  style="width:600px;">


*align=center|Базовая линия для стены*

<img alt="" src=images/02_T02_just_wall.png  style="width:600px;">


*align=center|Стена, полученная из полилинии*

## Установка стандартных дверей и окон 


<div class="mw-translate-fuzzy">

7\. Кликните инструмент [Arch Window](Arch_Window/ru.md); в ниспадающем списке Preset выделите `Simple door`, и установите высоту в 2 м.

:   7.1. Установите привязку на [Draft Midpoint](Draft_Midpoint/ru.md), и попробуйте выделить нижнюю грань передней стены; поверните [standard view](standard_view/ru.md) как требуется, чтобы зацепить грань, а не поверхность стены; когда активна средняя точка, кликните для установки двери.
:   7.2. Кликните снова инструмент [Arch Window](Arch_Window/ru.md), и установите другую дверь, на сей раз в средней точке крайней правой стены; поворачивайте [standard view](standard_view/ru.md) по необходимости.


</div>

<img alt="" src=images/03_T02_wall_place_doors.png  style="width:600px;">


*align=center|Захват по средней точке нижней грани стены для установки двери*


:   
    **Примечание:**`Sill height` это дистанция от пола до нижнего края элемента. Для дверей `Sill height` обычно 0 m, поскольку двери обычно на уровне пола; с другой стороны, окна обычно отделяет от пола от 0.5 до 1.5 m. `Sill height` может быть установлен только при создании окна или двери из заготовки. Когда окно или двери вставлены, корректируйте их размещение редактированием вектора **Position** `[x, y, z]` базового эскиза ([Sketch](Sketcher_Sketch/ru.md)).

## Создание пользовательских дверей и окон 

8\. Переключитесь на [верстак Sketcher](Sketcher_Workbench/ru.md); выделите часть стены справа, где нет двери; кликните на [Новый эскиз](Sketcher_NewSketch/ru.md); выделите **FlatFace** как метод прикрепления. Если существующая геометрия заслоняет ваш вид, кликните [Обзор эскиза](Sketcher_ViewSection/ru.md) чтобы спрятать её.

9\. Нарисуйте милый эскиз с тремя замкнутыми полилиниями. Убедитесь в наличии ограничений для всех полилиний.

:   9.1. Внешняя полилиния - наибольшая, определяет главный размер оконного объекта и размер выреза в стене при внедрении окна в [Arch Wall](Arch_Wall/ru.md). Убедитесь, что размеры подходяще названы, например `Width` и `Height`. Ограничения так же определяют curvature of the outer wire; дайте им подходящее имя, вроде `HeightCurve`.
:   9.2. Следующая полилиния это смещение от внешней полилинии, и вместе с ней определяет ширину замоноличиваемой в стену оконной коробки. Назовите смещение соответствующе, например, `FrameFixedOffset`. Он будет использован как для вертикального, так и горизонтального смещения. Нижнее смещение, при установке в ноль приведёт к касанию оконной коробкой низа окна, это можно использовать для моделирования двери вместо окна. Дайте ей подходящее имя, вроде `FrameFixedBottom`.
:   9.3. Третья, внутренняя полилиния это смещение от второй полилинии и вместе с ней определяет подвижную раму окна. Внутренняя полилиния так же определяет размер стекла. Ещё раз, дайте этим смещениям говорящие имена, например, `FrameInnerOffset` и `FrameInnerBottom`.
:   9.4. Чтобы успешно построить эскиз, используйте горизонтальные ([Sketcher ConstrainHorizontal](Sketcher_ConstrainHorizontal/ru.md)) вертикальные ([Sketcher ConstrainVertical](Sketcher_ConstrainVertical/ru.md)) ограничения для непосредственных сторон; используйте дополнительную конструктивную геометрию ([Sketcher ToggleConstruction](Sketcher_ToggleConstruction/ru.md)) и тангенциальные ограничения ([Sketcher ConstrainTangent](Sketcher_ConstrainTangent/ru.md)) для корректного размещения дуг наверху. Поскольку сейчас окно симметрично, не забывайте, когда нужно, ограничения равенства ([Sketcher ConstrainEqual](Sketcher_ConstrainEqual/ru.md)), симметрии ([Sketcher ConstrainSymmetric](Sketcher_ConstrainSymmetric/ru.md)) и точки на объекте ([Sketcher ConstrainPointOnObject](Sketcher_ConstrainPointOnObject/ru.md)).

![](images/04_T02_window_constraints_outer_frame.png )


*align=center|Ограничения для внешних полилиний эскиза, формирующих окно*

![](images/05_T02_window_constraints_inner_frame.png )


*align=center|Ограничения для внутренних полилиний эскиза, формирующих окно*

10\. Когда эскиз полностью зафиксирован, нажмите **Close** для выхода из эскиза ([Sketcher LeaveSketch](Sketcher_LeaveSketch/ru.md)).

:   10.1. Поскольку лицевая поверхность стены выбирается при начальных шагах создания эскиза, эскиз параллелен с ней, однако он может быть в неверной позиции, вне стены. В этом случае подстройте **Position** внутри **Attachment Offset**. Установите **Position** в `[4 m, 1 m, 0 m]`, так что эскиз будет центрирован по стене в одном метре от пола.
:   10.2. Вы можете видеть именованные ограничения эскиза в **Constraints**. Значения могут меняться с немедленным визуальным контролем изменений эскиза.

<img alt="" src=images/07_T02_window_sketch_in_wall.png  style="width:600px;">


*align=center|Эскиз окна движется к желательной позиции на стене*

<img alt="" src=images/06_T02_window_sketch_properties_constraints.png  style="width:600px;">


*align=center|Именованные ограничения эскиза, которые могут меняться без углубления в эскиз*

11\. Переключитесь обратно на [верстак Arch](Arch_Workbench/ru.md) и примените [Arch Window](Arch_Window.md) к выбранному новому `Sketch002`. Будет создано окно, и отверстие под него в стене. Окно сделано из пользовательского эскиза, а не стандартной заготовки, так что ему требуется редактирование для корректного отображения его компонентов, то есть неподвижной рамы, внутренней рамы, и стекла.

<img alt="" src=images/08_T02_window_basic_in_wall.png  style="width:600px;">


*align=center|Пользовательское окно, созданное из эскиза, у него пока нет правильной рамы или стекла*

## Настройка пользовательского окна 

12\. В древе проекта под `Window` выделите `Sketch002`, и нажмите **Space**, или измените свойство **Visibility** на `True`.

13\. Дважды кликните на `Window` в древе проекта для начала его редактирования.

:   13.1. Внутри диалога `Window elements` имеется две панели, `Wires` и `Components`. Там будет три полилинии, `Wire0`, `Wire1` и `Wire2`, и один компонент, `Default`. Полилинии указывают на замкнутые кривые, нарисованные на эскизе; компоненты определяют области на эскизе, которые будут выдавлены для создания рамы или стеклянной панели с реальной толщиной, эти области разделяются полилиниями. Окно, созданное из заготовки, уже имеет два компонента, `OuterFrame` и `Glass`. Пользовательское окно нужно редактировать для получения такой структуры.

![](images/09_T02_window_edit_default.png )


*align=center|Диалог редактирования окна или двери*


:   13.2. Кликните на `Default`, потом на кнопке **Remove** чтобы убрать его.





:   13.3. Кликните **Add**; что покажет параметры нового компонента вроде `Name`, `Type`, `Wires`, `Thickness`, `Offset`, `Hinge`, и `Opening mode`. Дайте имя, вроде `OuterFrame`, выделите `Frame` для типа `Type`, и кликните на `Wire0` и `Wire1`; они будут подсвечены в окне трёхмерного вида. Добавьте небольшое значение для `Thickness`, `15 mm`, и отметьте чекбокс для установки значения по умолчанию. Это значение по умолчанию будет длинной, назначенной параметру **Frame**; подобное умолчание может быть назначено для параметра **Offset**. Кликните на кнопке **+Create/update component**для завершения редактирования компонента.





:   13.4. Кликните **Add**; дайте другое имя, вроде `InnerFrame`, укажите `Frame` для `Type` и кликните на `Wire1` и `Wire2`. Добавьте подходящего размера `Thickness`, `60 mm`, и `Offset`, `15 mm`. Затем кликните кнопку **+Create/update component**.





:   13.5. Кликните **Add**; дайте другое имя, вроде `Glass`, выберите `Glass panel` для `Type`, и кликните `Wire2`. Добавьте подходящего размера `Thickness`, `10 mm` и `Offset`, `40 mm`. Затем кликните кнопку **+Create/update component**. Если любой из трёх компонентов нуждается в модификации, выделите его и нажмите **Edit**; модификация сохранится только после нажатия кнопки **+Create/update component**.

![](images/10_T02_window_edit_components.png )


*align=center|Редактирование ранее определённого компонента окна или двери*


:   13.6. Если всё установлено, кликните **Close** для завершения редактирования окна. Эскиз вновь станет не виден, но окно покажет различимые элементы для `OuterFrame`, для `InnerFrame`, и `Glass`. Задайте для **Frame** значение `100 mm` для толщины по умолчанию, которое будет добавлено к значению, определённому в компоненте `OuterFrame`.

![](images/11_T02_window_property_view.png )


*align=center|Вид параметров окна для добавления значений по умолчанию для Frame length, Offset length и других опций*

<img alt="" src=images/12_T02_window_finished.png  style="width:600px;">


*align=center|Итоговое окно с соответствующими компонентами, внедрёнными в стену*

## Размножение пользовательского окна 

14\. В древе проектов выделите `Window` и нижележащий `Sketch002`. Затем выполните **Edit → Duplicate selection**, и при запросе ответьте **No** для дублирования невыбранных зависимостей. Новые `Window001` и `Sketch003` появятся там же, где оригинальные элементы.


<div class="mw-translate-fuzzy">

15\. Выделите новый `Sketch003`. Перейдите к параметру **Map Mode** и кликните на эллипсе возле значения `FlatFace`. В окне трёхмерного вида выделите левую сторону стены без каких-либо элементов; поверните [standard view](standard_view/ru.md) куда надо. Измените `Attachment offset` на \[-1 m, 0 m, 0 m\] для центрирования окна, и кликните **OK**. Эскиз и окно появятся на новой позиции.

:   
    **Примечание:**[операция назначения](Part_Attachment.md) так же может быть выполнена переключением на [верстак Part](Part_Workbench/ru.md) и использованием меню **Part → Attachment**.


</div>

![](images/13_T02_sketch_attachment_edit.png )


*align=center|Диалог редактирования привязки плоскости эскиза*

16\. Вы можете настроить размеры нового окна изменением именованных параметров в `Sketch003` в **Constraints**, например, установив `Height` на `2 m`, и `Frame Fixed Bottom` на `0 m`. Затем нажмите **Ctrl**+**R** для [пересчёта](recompute/ru.md) модели. Если окно не показывает увеличенного проёма под новое окно, выделите стену в древе проекта, кликните правой кнопкой и выберите `Mark to recompute`, затем снова нажмите **Ctrl**+**R**.

17\. Эти операции меняют позиции нового окна, но проём в окне не выглядит правильно. Оно наклонено, то есть, проём не перпендикулярен поверхности стены, и может даже вырезать другие части стены. Проблема в том, что `Window001` сохранила информацию о **Normal** из оригинального `Window`.

<img alt="" src=images/14_T02_sketch_2_attached_slanted.png  style="width:600px;">


*align=center|Неправильный проём в стене из-за ошибочной нормали (Normal) окна*

## Нормали дверей и окон 

18\. Каждый объект [Arch Window](Arch_Window/ru.md) определяет выдавливание его тела, а так же отверстие, создаваемое в носящей его стене посредством **Normal**.

Нормаль - это вектор `[x, y, z]`, указывающий направление, перпендикулярное стене. Если заготовка окна или двери создаётся инструментом [Arch Window](Arch_Window/ru.md) прямо поверх [стены](Arch_Wall/ru.md), нормаль вычисляется автоматически, корректно выставляя получившееся окно или дверь. Так были созданы первые два объекта, `Door` и `Door001`.

Таким же образом, когда эскиз создаётся выделением плоскости, он ориентирован по этой плоскости. Затем, когда используется инструмент [Arch Window](Arch_Window/ru.md), окно использует как нормаль перпендикулярное направление к эскизу. Это было в случае с третьим объектом, пользовательским `Window`.

Если окно уже есть и его нужно передвинуть, как в случае с дублированным объектом `Window001`, эскиз требуется перепривязать к другой плоскости. Это сдвигает и эскиз и окно, но в дальнейшем его нормаль автоматически не обновляется, поскольку имеет некорректную информацию выдавливания. Нормаль нуждается в ручном пересчёте и записи в **Normal**.

Три значения вектора нормали высчитываются следующим образом. 
```python
x = -sin(angle)
y = cos(angle)
z = 0
``` Где `angle` - угол локальной оси Z эскиза относительно глобальной оси Y.

Когда создаётся эскиз, у него всегда две оси: локальная X (красная), и локальная Y (зелёная). Если эскиз привязан к глобальной рабочей плоскости XY, то эти оси выровнены, но если эскиз привязан к глобальным осям XZ или YZ, как это обычно бывает для окон и дверей (эскизы стоят вертикально), то локальная ось Z (голубая) составляет угол с глобальной осью Y, этот угол меняется от -180 до 180 градусов. Угол считается положительным, если он открывается против часовой стрелки, и отрицательный, если по часовой, начиная с глобальной оси Y.

<img alt="" src=images/15_T02_sketch_local_coordinates.png  style="width:600px;">


*align=center|Локальные координаты вертикально стоящего эскиза, то есть сопоставлен с глобальной плоскостью XZ*

<img alt="" src=images/16_T02_sketch_correct_normal_direction.png  style="width:600px;">


*align=center|Намеченные направления нормалей для каждой двери и окна*

Если мы посмотрим на до сих пор сделанную геометрию, мы увидим следующие нормали.

`Door`
:   Локальное Z выравнено с глобальным Y, значит, `angle` равен нулю. Нормальный вектор


```python
x = -sin(0) = 0
y = cos(0) = 1
z = 0
```

или **Normal** соответствует `[0, 1, 0]`.

`Door001`
:   Локальное Z повёрнуто на 90 градусов относительно глобальной Y, значит, `angle` равен 90 (положительно, поскольку открыт против часовой стрелки). Вектор нормали равен


```python
x = -sin(90) = -1
y = cos(90) = 0
z = 0
```

или **Normal** равен `[-1, 0, 0]`.

`Window`
:   Локальное Z повёрнуто на 45 градусов от глобальной Y, значит `angle` равен 45 (положительный, поскольку открывается против часовой стрелки). Нормальный вектор равен


```python
x = -sin(45) = -0.7071
y = cos(45) = 0.7071
z = 0
```

или **Normal** равен `[-0.7071, 0.7071, 0]`.

`Window001`
:   Направление локального Z находится использованием инструмента [Draft Dimension](Draft_Dimension/ru.md) и измерением угла, который направляющая стены (`Wire`) составляет с глобальной осью Y, или любая линия, выровненная по ней. Этот угол равен `26.57`; требуемый угол является дополнительным к этому, так что 90 - 26.57 = 63.43.

Это означает, что локальная ось Z повёрнута на 63.43 градусов от глобальной Y, значит, `angle` соответствует -63.46 (отрицательный, поскольку открывается по часовой стрелке). Вектор нормали 
```python
x = -sin(-63.43) = 0.8943
y = cos(-63.43) = 0.4472
z = 0
``` Значит, **Normal** должен быть установлен в `[0.8943, 0.4472, 0]`.

После выполнения изменений пересчитайте модель нажатием **Ctrl**+**R**. Если стена не обновит отверстие, выделите его в древе проекта, и по клику правой кнопки мыши выделите `Mark to recompute`, затем нажмите **Ctrl**+**R** вновь.

19\. Ориентация выдавливания окна решена, вместе с отверстием в стене.

<img alt="" src=images/17_T02_sketch_2_attached_correctly.png  style="width:600px;">


*align=center|Корректный проём в стене в соответствии с нормалью окна*

## Конечные замечания 

20\. Как показано, [Arch Window](Arch_Window/ru.md) очень важно. Пользователь должен либо

-   Использовать инструмент [Arch Window](Arch_Window/ru.md) для вставки автоматического выравнивания заготовки в стену, или
-   привязать эскиз к желаемой стене и построить окно на нём.

Если окно уже существует, и его надо подвинуть, базовый эскиз должен быть перепривязан к новой плоскости, и **Normal** окна надо будет пересчитать.

Направление новой нормали может быть получено измерением `angle` новой стены относительно оси Y, учитывая, является ли этот угол положительным (против часовой стрелки) или отрицательным (по часовой стрелке), и использованием простой формулы. 
```python
x = -sin(angle)
y = cos(angle)
z = 0
```

Для проверки корректности операции, абсолютная величина вектора нормали должна быть равна единице. То есть: 
```python
abs(N) = 1 = sqrt(x^2 + y^2 + z^2)
abs(N) = 1 = sqrt(sin^2(angle) + cos^2(angle) + z^2)
```


{{Tutorials navi

}}   {{Sketcher Tools navi}}

---
[documentation index](../README.md) > [Arch](Category:Arch.md) > Tutorial custom placing of windows and doors/ru
